<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DREVO</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        /* Light Theme Variables */
        .theme-light {
            --primary: #8B4513;
            --primary-light: #A0522D;
            --primary-dark: #654321;
            --bg: #F5F5F5;
            --card: #FFFFFF;
            --text: #2C2C2C;
            --secondary: #666666;
            --border: #E0E0E0;
            --accent: #D2691E;
            --gradient: linear-gradient(135deg, #FFFFFF 0%, #F8F8F8 100%);
            --autumn-gradient: linear-gradient(135deg, #8B4513 0%, #D2691E 50%, #F4A460 100%);
        }
        
        /* Dark Theme Variables */
        .theme-dark {
            --primary: #00B894;
            --primary-light: #00D4AA;
            --primary-dark: #009975;
            --bg: #0A0A0A;
            --card: #1A1A1A;
            --text: #FFFFFF;
            --secondary: #A0A0A0;
            --border: #2A2A2A;
            --accent: #2EA6FF;
            --gradient: linear-gradient(135deg, #1A1A1A 0%, #2A2A2A 100%);
            --autumn-gradient: linear-gradient(135deg, #00B894 0%, #00D4AA 50%, #2EA6FF 100%);
        }

        body { 
            font-family: 'Roboto', sans-serif; 
            background: var(--bg); 
            color: var(--text); 
            height: 100vh; 
            overflow: hidden;
            transition: all 0.3s ease;
        }
        .app { height: 100vh; display: flex; flex-direction: column; }
        
        /* Header */
        .header { background: var(--card); padding: 12px 16px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .logo { display: flex; align-items: center; gap: 8px; font-size: 20px; font-weight: 700; background: var(--autumn-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .balance-section { display: flex; align-items: center; gap: 12px; }
        .balance-card, .energy-section { background: var(--gradient); padding: 8px 12px; border-radius: 12px; display: flex; align-items: center; gap: 6px; font-size: 14px; font-weight: 600; border: 1px solid var(--border); }
        .balance-icon { color: var(--primary); }
        
        /* Navigation */
        .tabs { display: flex; background: var(--card); margin: 12px; border-radius: 16px; overflow: hidden; border: 1px solid var(--border); box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .tab-btn { flex: 1; padding: 14px; background: none; border: none; color: var(--secondary); font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease; }
        .tab-btn.active { background: var(--autumn-gradient); color: white; }
        
        /* Content */
        .content { flex: 1; overflow-y: auto; padding: 0 12px 20px; }
        .tab-content { display: none; height: 100%; }
        .tab-content.active { display: block; }
        
        /* Clicker Section */
        .clicker-section { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; }
        .daily-bonus { background: var(--autumn-gradient); padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; margin-bottom: 20px; color: white; }
        .clicker-circle { width: 220px; height: 220px; border-radius: 50%; background: var(--card); display: flex; align-items: center; justify-content: center; margin: 20px 0; position: relative; border: 3px solid var(--primary); box-shadow: 0 8px 25px rgba(139, 69, 19, 0.2); overflow: hidden; }
        .theme-dark .clicker-circle { box-shadow: 0 8px 25px rgba(0, 184, 148, 0.3); }
        .clicker-btn { width: 100%; height: 100%; border-radius: 50%; border: none; cursor: pointer; transition: all 0.1s ease; background: transparent; padding: 0; }
        .clicker-btn:active { transform: scale(0.95); }
        .clicker-image { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; }
        .stats-section { background: var(--card); border-radius: 16px; padding: 16px; width: 100%; max-width: 320px; border: 1px solid var(--border); box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .stat-row { display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 14px; }
        .progress-bar { width: 100%; height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; margin-top: 4px; }
        .progress-fill { height: 100%; background: var(--autumn-gradient); border-radius: 3px; transition: width 0.3s ease; }
        
        /* Tasks Section */
        .tasks-section { background: var(--card); border-radius: 16px; padding: 20px; margin-top: 20px; border: 1px solid var(--border); box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .section-title { font-size: 16px; font-weight: 600; margin-bottom: 16px; color: var(--primary); }
        .tasks-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .task-card { background: var(--gradient); border-radius: 12px; padding: 16px; text-align: center; border: 1px solid var(--border); }
        .task-title { font-size: 12px; color: var(--secondary); margin-bottom: 4px; }
        .task-reward { font-size: 14px; font-weight: 700; color: var(--primary); }
        .task-btn { width: 100%; padding: 8px; background: var(--autumn-gradient); border: none; border-radius: 8px; color: white; font-size: 12px; font-weight: 600; cursor: pointer; margin-top: 8px; transition: all 0.3s ease; }
        .task-btn:hover { opacity: 0.9; }
        .task-btn.completed { background: var(--secondary); cursor: not-allowed; }
        
        /* Investments Section */
        .investments-section { padding: 20px 0; }
        .investments-info { background: rgba(210, 105, 30, 0.1); border: 1px solid var(--accent); border-radius: 12px; padding: 16px; margin-bottom: 20px; font-size: 12px; line-height: 1.4; color: var(--primary); }
        .theme-dark .investments-info { background: rgba(46, 166, 255, 0.1); }
        .investments-grid { display: grid; grid-template-columns: 1fr; gap: 12px; }
        .investment-card { background: var(--card); border-radius: 16px; padding: 20px; border: 1px solid var(--border); box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .investment-header { display: flex; align-items: center; margin-bottom: 16px; }
        .investment-icon { width: 40px; height: 40px; border-radius: 10px; background: var(--autumn-gradient); display: flex; align-items: center; justify-content: center; font-weight: 600; margin-right: 12px; color: white; }
        .investment-info { flex: 1; }
        .investment-name { font-size: 16px; font-weight: 600; margin-bottom: 4px; color: var(--primary); }
        .investment-details { font-size: 12px; color: var(--secondary); }
        .investment-stats { display: flex; justify-content: space-between; margin-bottom: 16px; }
        .stat { text-align: center; }
        .stat-value { font-size: 18px; font-weight: 700; color: var(--primary); }
        .stat-label { font-size: 10px; color: var(--secondary); margin-top: 4px; }
        .buy-btn { width: 100%; padding: 12px; background: var(--autumn-gradient); border: none; border-radius: 8px; color: white; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
        .buy-btn:hover { opacity: 0.9; }
        .buy-btn:disabled { background: var(--secondary); cursor: not-allowed; }
        
        /* Profile Section */
        .profile-section { padding: 20px 0; }
        .profile-card { background: var(--card); border-radius: 16px; padding: 24px; border: 1px solid var(--border); box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .profile-header { display: flex; align-items: center; gap: 16px; margin-bottom: 20px; }
        .profile-avatar { width: 64px; height: 64px; border-radius: 50%; background: var(--autumn-gradient); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 24px; color: white; }
        .profile-info { flex: 1; }
        .profile-username { font-size: 18px; font-weight: 600; margin-bottom: 4px; color: var(--primary); }
        .profile-stats { font-size: 14px; color: var(--secondary); }
        
        /* Theme Switcher */
        .theme-switcher { background: var(--gradient); border-radius: 12px; padding: 16px; margin-bottom: 20px; border: 1px solid var(--border); }
        .theme-title { font-size: 16px; font-weight: 600; margin-bottom: 12px; color: var(--primary); }
        .theme-buttons { display: flex; gap: 12px; }
        .theme-btn { flex: 1; padding: 12px; border: 2px solid var(--border); border-radius: 8px; background: var(--card); color: var(--text); font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
        .theme-btn.active { border-color: var(--primary); background: var(--autumn-gradient); color: white; }
        
        .profile-motivation { background: var(--gradient); border-radius: 16px; padding: 20px; text-align: center; border: 1px solid var(--border); }
        .motivation-image { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; margin: 0 auto 16px; border: 3px solid var(--primary); }
        .motivation-title { font-size: 16px; font-weight: 600; margin-bottom: 8px; color: var(--primary); }
        .motivation-text { font-size: 14px; color: var(--secondary); line-height: 1.4; }
        
        /* Animations */
        @keyframes coinPop { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-60px) scale(1.1); opacity: 0; } }
        .coin-pop { animation: coinPop 0.8s ease-out forwards; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        .pulse { animation: pulse 2s infinite; }
        
        /* Loading */
        .loading { text-align: center; padding: 40px; color: var(--secondary); }
    </style>
</head>
<body class="theme-light">
    <div class="app">
        <div class="header">
            <div class="logo">DREVO</div>
            <div class="balance-section">
                <div class="energy-section"><span id="energy">1000/1000</span></div>
                <div class="balance-card"><span class="balance-icon">D</span><span id="balance">0</span></div>
            </div>
        </div>
        
        <!-- Navigation -->
        <nav class="tabs">
            <button class="tab-btn active" onclick="switchTab('clicker')">Clicker</button>
            <button class="tab-btn" onclick="switchTab('tasks')">Tasks</button>
            <button class="tab-btn" onclick="switchTab('investments')">Investments</button>
            <button class="tab-btn" onclick="switchTab('profile')">Profile</button>
        </nav>
        
        <main class="content">
            <!-- Clicker Tab -->
            <div id="clicker-tab" class="tab-content active">
                <div class="clicker-section">
                    <div class="daily-bonus">Daily limit</div>
                    <div class="clicker-circle">
                        <button class="clicker-btn pulse" id="click-btn">
                            <img src="https://i.postimg.cc/3Jzfvb3c/IMG-20251002-224117-911.jpg" alt="DREVO" class="clicker-image" onerror="this.style.display='none'">
                        </button>
                    </div>
                    <div class="stats-section">
                        <div class="stat-row"><span>Points per tap</span><span>+1</span></div>
                        <div class="stat-row"><span>Daily limit</span><span id="today-limit">0/1000</span></div>
                        <div class="progress-bar"><div class="progress-fill" id="progress-fill" style="width: 0%"></div></div>
                    </div>
                </div>
            </div>
            
            <!-- Tasks Tab -->
            <div id="tasks-tab" class="tab-content">
                <div class="tasks-section">
                    <div class="section-title">Tasks</div>
                    <div class="tasks-grid">
                        <div class="task-card" id="task-channel1">
                            <div class="task-title">Join DREVO Coin</div>
                            <div class="task-reward">+1000 D</div>
                            <button class="task-btn" onclick="completeTask('channel1')" id="btn-channel1">Join</button>
                        </div>
                        <div class="task-card" id="task-channel2">
                            <div class="task-title">Join OneSK</div>
                            <div class="task-reward">+1000 D</div>
                            <button class="task-btn" onclick="completeTask('channel2')" id="btn-channel2">Join</button>
                        </div>
                        <div class="task-card" id="task-channel3">
                            <div class="task-title">Join BioSprutEl</div>
                            <div class="task-reward">+1000 D</div>
                            <button class="task-btn" onclick="completeTask('channel3')" id="btn-channel3">Join</button>
                        </div>
                        <div class="task-card" id="task-chat">
                            <div class="task-title">Join DREVO Community</div>
                            <div class="task-reward">+1000 D</div>
                            <button class="task-btn" onclick="completeTask('chat')" id="btn-chat">Join</button>
                        </div>
                        <div class="task-card" id="task-invite">
                            <div class="task-title">Invite Friends</div>
                            <div class="task-reward">+500 D</div>
                            <button class="task-btn" onclick="completeTask('invite')" id="btn-invite">Invite</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Investments Tab -->
            <div id="investments-tab" class="tab-content">
                <div class="investments-section">
                    <div class="investments-info">
                        ⚠️ Important: Investments generate coins only while you are actively in the game. When you exit, income stops.
                    </div>
                    <div class="investments-grid">
                        <div class="investment-card">
                            <div class="investment-header">
                                <div class="investment-icon">T</div>
                                <div class="investment-info">
                                    <div class="investment-name">Telegram</div>
                                    <div class="investment-details">Social platform</div>
                                </div>
                            </div>
                            <div class="investment-stats">
                                <div class="stat">
                                    <div class="stat-value">2600</div>
                                    <div class="stat-label">Cost</div>
                                </div>
                                <div class="stat">
                                    <div class="stat-value">1/min</div>
                                    <div class="stat-label">Income</div>
                                </div>
                            </div>
                            <button class="buy-btn" onclick="buyInvestment('telegram')" id="buy-telegram">Buy Telegram</button>
                        </div>
                        
                        <div class="investment-card">
                            <div class="investment-header">
                                <div class="investment-icon">Y</div>
                                <div class="investment-info">
                                    <div class="investment-name">YouTube</div>
                                    <div class="investment-details">Video platform</div>
                                </div>
                            </div>
                            <div class="investment-stats">
                                <div class="stat">
                                    <div class="stat-value">3300</div>
                                    <div class="stat-label">Cost</div>
                                </div>
                                <div class="stat">
                                    <div class="stat-value">1/min</div>
                                    <div class="stat-label">Income</div>
                                </div>
                            </div>
                            <button class="buy-btn" onclick="buyInvestment('youtube')" id="buy-youtube">Buy YouTube</button>
                        </div>
                        
                        <div class="investment-card">
                            <div class="investment-header">
                                <div class="investment-icon">T</div>
                                <div class="investment-info">
                                    <div class="investment-name">Twitch</div>
                                    <div class="investment-details">Streaming platform</div>
                                </div>
                            </div>
                            <div class="investment-stats">
                                <div class="stat">
                                    <div class="stat-value">4200</div>
                                    <div class="stat-label">Cost</div>
                                </div>
                                <div class="stat">
                                    <div class="stat-value">2/min</div>
                                    <div class="stat-label">Income</div>
                                </div>
                            </div>
                            <button class="buy-btn" onclick="buyInvestment('twitch')" id="buy-twitch">Buy Twitch</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Profile Tab -->
            <div id="profile-tab" class="tab-content">
                <div class="profile-section">
                    <div class="profile-card">
                        <div class="profile-header">
                            <div class="profile-avatar" id="profile-avatar">U</div>
                            <div class="profile-info">
                                <div class="profile-username" id="profile-username">User</div>
                                <div class="profile-stats" id="profile-stats">0 coins • Just started</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="theme-switcher">
                        <div class="theme-title">Theme</div>
                        <div class="theme-buttons">
                            <button class="theme-btn active" onclick="switchTheme('light')">Light</button>
                            <button class="theme-btn" onclick="switchTheme('dark')">Dark</button>
                        </div>
                    </div>
                    
                    <div class="profile-motivation">
                        <img src="https://i.postimg.cc/3Jzfvb3c/IMG-20251002-224117-911.jpg" alt="Dreams" class="motivation-image" onerror="this.style.display='none'">
                        <div class="motivation-title">Dreams Come True</div>
                        <div class="motivation-text">
                            Coming soon: Leaderboard ranking system. Early players and top leaders will receive exclusive advantages during the currency listing on exchanges. Your dedication today builds your success tomorrow.
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        class DREVOApp {
            #tg = window.Telegram.WebApp;
            #incomeInterval = null;
            
            state = {
                balance: 0,
                energy: 1000,
                clicksToday: 0,
                completedTasks: {
                    channel1: false,
                    channel2: false,
                    channel3: false,
                    chat: false,
                    invite: false
                },
                investments: {
                    telegram: false,
                    youtube: false,
                    twitch: false
                },
                userId: null,
                username: 'User',
                registrationDate: null,
                lastClickDate: null,
                theme: 'light'
            };

            constructor() {
                this.init();
            }

            init() {
                this.#tg.expand();
                this.setupUser();
                this.loadState();
                this.setupEventListeners();
                this.startIncomeGeneration();
                this.updateUI();
                this.updateProfile();
                this.applyTheme(this.state.theme);
            }

            setupUser() {
                const user = this.#tg.initDataUnsafe.user;
                this.state.userId = user?.id || Math.floor(Math.random() * 1000000000);
                this.state.username = user?.first_name || `User${this.state.userId.toString().slice(-4)}`;
                
                if (!this.state.registrationDate) {
                    this.state.registrationDate = Date.now();
                }
            }

            switchTab(tabName, event) {
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                event.target.classList.add('active');
                document.getElementById(`${tabName}-tab`).classList.add('active');
                
                if (tabName === 'tasks') this.updateTasksUI();
                if (tabName === 'investments') this.updateInvestmentsUI();
                if (tabName === 'profile') this.updateProfile();
            }

            switchTheme(themeName) {
                this.state.theme = themeName;
                this.applyTheme(themeName);
                this.saveState();
                
                // Update theme buttons
                document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
                event.target.classList.add('active');
            }

            applyTheme(themeName) {
                document.body.className = `theme-${themeName}`;
            }

            loadState() {
                const userKey = `drevoState_${this.state.userId}`;
                const saved = localStorage.getItem(userKey);
                
                if (saved) {
                    try {
                        const parsed = JSON.parse(saved);
                        const today = new Date().toDateString();
                        
                        // Reset daily limits if new day
                        if (parsed.lastClickDate !== today) {
                            this.state.clicksToday = 0;
                            this.state.energy = 1000;
                        } else {
                            this.state.clicksToday = parsed.clicksToday || 0;
                            this.state.energy = 1000 - this.state.clicksToday;
                        }
                        
                        // Load all state data
                        this.state.balance = parsed.balance || 0;
                        this.state.completedTasks = parsed.completedTasks || this.state.completedTasks;
                        this.state.investments = parsed.investments || this.state.investments;
                        this.state.registrationDate = parsed.registrationDate || Date.now();
                        this.state.lastClickDate = today;
                        this.state.theme = parsed.theme || 'light';
                        
                    } catch (error) {
                        console.error('Error loading state:', error);
                        this.resetState();
                    }
                } else {
                    this.resetState();
                }
                
                this.saveState();
            }

            resetState() {
                this.state.balance = 0;
                this.state.energy = 1000;
                this.state.clicksToday = 0;
                this.state.completedTasks = {
                    channel1: false,
                    channel2: false,
                    channel3: false,
                    chat: false,
                    invite: false
                };
                this.state.investments = {
                    telegram: false,
                    youtube: false,
                    twitch: false
                };
                this.state.registrationDate = Date.now();
                this.state.lastClickDate = new Date().toDateString();
                this.state.theme = 'light';
            }

            saveState() {
                const userKey = `drevoState_${this.state.userId}`;
                this.state.lastClickDate = new Date().toDateString();
                localStorage.setItem(userKey, JSON.stringify(this.state));
            }

            setupEventListeners() {
                document.getElementById('click-btn').addEventListener('click', () => this.handleClick());
            }

            startIncomeGeneration() {
                if (this.#incomeInterval) {
                    clearInterval(this.#incomeInterval);
                }
                
                this.#incomeInterval = setInterval(() => {
                    let income = 0;
                    
                    if (this.state.investments.telegram) income += 1;
                    if (this.state.investments.youtube) income += 1;
                    if (this.state.investments.twitch) income += 2;
                    
                    if (income > 0) {
                        this.state.balance += income;
                        this.saveState();
                        this.updateUI();
                        this.updateProfile();
                    }
                }, 60000);
            }

            handleClick() {
                if (this.state.energy <= 0) {
                    this.#tg.showAlert('Daily limit reached!');
                    return;
                }
                this.state.balance++;
                this.state.energy--;
                this.state.clicksToday++;
                this.showCoinAnimation();
                this.#tg.HapticFeedback.impactOccurred('light');
                this.saveState();
                this.updateUI();
                this.updateProfile();
            }

            showCoinAnimation() {
                const coin = document.createElement('div');
                coin.className = 'coin-pop';
                coin.textContent = '+1';
                coin.style.cssText = 'position:absolute;font-size:16px;font-weight:700;color:var(--primary);opacity:0;';
                document.getElementById('click-btn').parentElement.appendChild(coin);
                setTimeout(() => coin.remove(), 800);
            }

            completeTask(taskId) {
                // Check if task already completed
                if (this.state.completedTasks[taskId]) {
                    this.#tg.showAlert('Task already completed!');
                    return;
                }

                const urls = {
                    channel1: 'https://t.me/drevocoin',
                    channel2: 'https://t.me/onesk',
                    channel3: 'https://t.me/biosprutel',
                    chat: 'https://t.me/drevocommunity',
                    invite: 'https://t.me/share/url?url=https://t.me/drevo_bot'
                };

                // Open the link
                if (urls[taskId]) {
                    this.#tg.openLink(urls[taskId]);
                }

                // Give reward immediately
                const reward = taskId === 'invite' ? 500 : 1000;
                this.state.balance += reward;
                this.state.completedTasks[taskId] = true;
                this.#tg.HapticFeedback.impactOccurred('success');

                this.#tg.showPopup({
                    title: 'Task Completed!',
                    message: `You received ${reward} DREVO points!`,
                    buttons: [{ type: 'ok' }]
                });

                this.saveState();
                this.updateUI(); // ОБНОВЛЯЕМ ИНТЕРФЕЙС СРАЗУ!
                this.updateTasksUI();
                this.updateProfile();
            }

            buyInvestment(investmentId) {
                const prices = {
                    telegram: 2600,
                    youtube: 3300,
                    twitch: 4200
                };

                const price = prices[investmentId];

                if (this.state.balance < price) {
                    this.#tg.showAlert(`Not enough coins! You need ${price} coins.`);
                    return;
                }

                if (this.state.investments[investmentId]) {
                    this.#tg.showAlert('You already own this investment!');
                    return;
                }

                this.state.balance -= price;
                this.state.investments[investmentId] = true;

                this.#tg.showPopup({
                    title: 'Investment Purchased!',
                    message: `You successfully bought ${investmentId.charAt(0).toUpperCase() + investmentId.slice(1)}!`,
                    buttons: [{ type: 'ok' }]
                });

                this.saveState();
                this.updateUI();
                this.updateInvestmentsUI();
                this.updateProfile();
            }

            updateUI() {
                // ОБНОВЛЯЕМ БАЛАНС В ХЕДЕРЕ И ВСЕ СТАТИСТИКИ
                document.getElementById('balance').textContent = this.state.balance.toLocaleString();
                document.getElementById('energy').textContent = `${this.state.energy}/1000`;
                document.getElementById('today-limit').textContent = `${this.state.clicksToday}/1000`;
                document.getElementById('progress-fill').style.width = `${(this.state.clicksToday / 1000) * 100}%`;

                const clickBtn = document.getElementById('click-btn');
                if (this.state.energy <= 0) {
                    clickBtn.classList.remove('pulse');
                    clickBtn.style.opacity = '0.6';
                } else {
                    clickBtn.classList.add('pulse');
                    clickBtn.style.opacity = '1';
                }
            }

            updateTasksUI() {
                const taskIds = ['channel1', 'channel2', 'channel3', 'chat', 'invite'];
                taskIds.forEach(taskId => {
                    const btn = document.getElementById(`btn-${taskId}`);
                    if (btn) {
                        if (this.state.completedTasks[taskId]) {
                            btn.textContent = 'Completed';
                            btn.disabled = true;
                            btn.classList.add('completed');
                        } else {
                            btn.textContent = taskId === 'invite' ? 'Invite' : 'Join';
                            btn.disabled = false;
                            btn.classList.remove('completed');
                        }
                    }
                });
            }

            updateInvestmentsUI() {
                const investments = ['telegram', 'youtube', 'twitch'];
                investments.forEach(investment => {
                    const btn = document.getElementById(`buy-${investment}`);
                    if (btn) {
                        if (this.state.investments[investment]) {
                            btn.textContent = 'Owned';
                            btn.disabled = true;
                        } else {
                            const prices = { telegram: 2600, youtube: 3300, twitch: 4200 };
                            btn.textContent = `Buy ${investment.charAt(0).toUpperCase() + investment.slice(1)}`;
                            btn.disabled = this.state.balance < prices[investment];
                        }
                    }
                });
            }

            updateProfile() {
                // Update avatar and username
                document.getElementById('profile-avatar').textContent = this.state.username.charAt(0).toUpperCase();
                document.getElementById('profile-username').textContent = this.state.username;

                // Calculate time since registration
                const timeDiff = Date.now() - this.state.registrationDate;
                const days = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((timeDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));

                let timeText = '';
                if (days > 0) {
                    timeText = `${days} day${days > 1 ? 's' : ''}`;
                } else if (hours > 0) {
                    timeText = `${hours} hour${hours > 1 ? 's' : ''}`;
                } else {
                    timeText = `${minutes} minute${minutes > 1 ? 's' : ''}`;
                }

                document.getElementById('profile-stats').textContent =
                    `${this.state.balance.toLocaleString()} coins • Playing for ${timeText}`;
                    
                // Update theme buttons
                document.querySelectorAll('.theme-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.textContent.toLowerCase() === this.state.theme) {
                        btn.classList.add('active');
                    }
                });
            }
        }

        // Global functions for HTML onclick
        function switchTab(tabName) {
            app.switchTab(tabName, event);
        }

        function completeTask(taskId) {
            app.completeTask(taskId);
        }

        function buyInvestment(investmentId) {
            app.buyInvestment(investmentId);
        }

        function switchTheme(themeName) {
            app.switchTheme(themeName);
        }

        // Initialize app
        let app;
        document.addEventListener('DOMContentLoaded', () => {
            app = new DREVOApp();
        });
    </script>
</body>
</html>